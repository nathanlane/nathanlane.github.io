<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <base href="">
    <title>Input-Output Tables & the Leontief Inverse in R - Part I. - Nathan Lane - nathanlane.github.io</title>
    <meta name="author" content="Dr. Nathan Lane">
    <meta name="description" content="The personal webpage of Assistant Professor/Lecturer, Nathaniel Lane.">
    <link rel="stylesheet" href="/main.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Karla:300,400,700">
</head>
<body>

<header class="block block-header-1">

  <div class="block-header-1--logo">
  <a href="http://nathanlane.info">Nathanlane.info</a>
  </div>

  <div class="block-header-1--nav">
    <ul>
      
      <li class="nav-item "><a href="">Main</a></li>
      
      <li class="nav-item "><a href="http://nathanlane.info/blog">Blog</a></li>
      
      <li class="nav-item "><a href="https://www.dropbox.com/s/2xgg325wwayo9s9/NathanLane_IIES_20172018.pdf?dl=0">CV</a></li>
      
    </ul>
  </div>

</header>

<section class="post--content">
	<section class="block block-one-column-1">
	  <div class="container">
	    <div class="columns">
	      <div class="column">

			  <h1>Input-Output Tables & the Leontief Inverse in R - Part I.</h1>
			  <p></p>

			  <p><img src="/assets/surahammarssweden.jpg" width="700px" />
<small>Surahammars Ironworks/Surahammars Järnbruk, Sweden, 1919.<br />
<a href="www.tekniskamuseet.se/1/706.html">From Sweden’s Tekniska Museet photo collection</a>.</small></p>

<p>In input-output economics, the <strong>Leontief inverse</strong> (i.e. [I-A]^-1) is ubiquitous. Named after the father of input-output economics, <a href="http://www.nobelprize.org/nobel_prizes/economic-sciences/laureates/1973/leontief-bio.html">Wassily Leontief</a>, the matrix is a compact representation of the ripple effects in an economy where industries are interconnected. A lone matrix coefficient conveys all direct and indirect effects on output in one sector required by a unit of output from another sector.</p>

<p>Below is Part 1 of a two part tutorial on deriving the Leontief inverse using R. This first part is a “toy” example to motivated the pieces of the input-output analysis and the workflow in R. Part 2 describes how to calculate the Leontief inverse from a full scale input-output table.</p>

<h4>A Toy Input-Output Model.</h4>

<p>Consider a baby example. I’ll use <strong>Table 1</strong> as a guide to calculating a simple Leontief inverse using R. The table represents the essential ingredients of common input-output tables using only two sectors.</p>

<p><strong>Table 1. A Small Input-Output Table</strong></p>

<table>
<tbody>
<tr>
<td> </td>
<td colspan="2"><center>Intermediates</center></td>
<td> </td>
<td> </td>
</tr>
<tr>
<td>From / To</td>
<td>Good 1</td>
<td>Good 2</td>
<td>Final Goods</td>
<td>Total Output</td>
</tr>
<tr style="border-top:1px solid darkgray;">
<td>Good 1</td>
<td>150</td>
<td>500</td>
<td>350</td>
<td>1000</td>
</tr>
<tr style="border-top:1px solid darkgray;">
<td>Good 2</td>
<td>200</td>
<td>100</td>
<td>1700</td>
<td>2000</td>
</tr>
</tbody>
</table>
<p><small>The above example borrows from the canonical examples in chapter 2 of Miller and Blair’s <u>Input-Output Analysis</u> (1985) as well as chapter 2 of Leontief’s <u>Input-Output Economics</u> (1986).
</small></p>

<p>The heart of the table is a two-by-two matrix representing the intermediate good flows between the two sectors: sector 1 and sector 2. A row represents the value of output sent from a goods sector for productive use in a column sector. Above, a row sector sends goods to itself and sector 2.</p>

<p>After the two columns of intermediate good sales, the “Final Goods” column shows the value of a row’s output used as final products–output not used in production. If we add up a row’s output used as intermediate goods and as final products, we get the last column: total output.</p>

<h4>Calculating the Matrix</h4>

<p>The Leontief inverse is calculated in the following way. We start with an IO table like the one above. Using this basic IO table, we generate a “technical coefficient matrix,” which we then use to solve for the Leontient inverse matrix, L.</p>

<script type="math/tex; mode=display">\textrm{Basic IO Table: }~ X \Rightarrow \textrm{Technical Matrix: }~ A \Rightarrow \textrm{Leontief Matrix: }~ L</script>

<p>First we’ll build the input-output table in Table 1 using R. We generate the two-by-two flow of interindustry sales (<code>flowtable</code>). Then I create the vector of <code>finaldemand</code>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Intermediate flow matrix.</span><span class="w">
</span><span class="n">flowtable</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">150</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="m">500</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="c1"># Final demand.</span><span class="w">
</span><span class="n">finaldemand</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">350</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">1700</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span></code></pre></figure>

<p>We combined these pieces into a <code>data.frame</code> object. Once combined, we sum across the intermediate input columns and final demand column to produce a new variable: total demand. The result is a <code>data.frame</code> version of Table 1.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Bind into input-output table.</span><span class="w">
</span><span class="n">inputoutputtable</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="w"> </span><span class="n">flowtable</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">finaldemand</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="c1"># Convert object to data.frame.</span><span class="w">
</span><span class="n">inputoutputtable</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="w"> </span><span class="n">inputoutputtable</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="c1"># Name columns of table (dataframe)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="w"> </span><span class="n">inputoutputtable</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"x1"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s2">"x2"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s2">"finaldemand"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Calculate total output, add final demand and intermediate columns:</span><span class="w">
</span><span class="n">inputoutputtable</span><span class="o">$</span><span class="n">totaloutput</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">inputoutputtable</span><span class="o">$</span><span class="n">x</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w">
                                </span><span class="n">inputoutputtable</span><span class="o">$</span><span class="n">x</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w">
                                </span><span class="n">inputoutputtable</span><span class="o">$</span><span class="n">finaldemand</span><span class="w">

</span><span class="c1"># Show the small IO table.</span><span class="w">
</span><span class="n">inputoutputtable</span><span class="w">
</span><span class="o">&gt;</span><span class="w">   </span><span class="n">x</span><span class="m">1</span><span class="w">  </span><span class="n">x</span><span class="m">2</span><span class="w"> </span><span class="n">finaldemand</span><span class="w"> </span><span class="n">totaloutput</span><span class="w">
</span><span class="o">&gt;</span><span class="m">1</span><span class="w"> </span><span class="m">150</span><span class="w"> </span><span class="m">500</span><span class="w">         </span><span class="m">350</span><span class="w">        </span><span class="m">1000</span><span class="w">
</span><span class="o">&gt;</span><span class="m">2</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">100</span><span class="w">         </span><span class="m">1700</span><span class="w">       </span><span class="m">2000</span><span class="w">

</span><span class="c1"># Save total output vector as a separate object. Use later.</span><span class="w">
</span><span class="n">totaloutput</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">inputoutputtable</span><span class="o">$</span><span class="n">totaloutput</span></code></pre></figure>

<p>Now we can derive a <strong>technical coefficient matrix</strong>, also called <strong>matrix A</strong>. A column of this matrix represents an industrial recipe used to produce a single industry good.</p>

<p>Matrix A is calculated by dividing intersectoral flows by the total output of each column’s sector. Specifically, sector 1 ships 500 dollars of good 1 to sector 2, which produces 1000 dollars of total output. Thus, one dollar of good 1 is absorbed to produce 25 cents of sector 2’s output.</p>

<script type="math/tex; mode=display">% <![CDATA[
\textrm{Input Flow Matrix: }~X  = \left[ \begin{matrix} 150 & 500 \\\ 200 & 100 \end{matrix} \right]~
\\\
z = \textrm{I}_2 \textrm{Total Output}^{-1} =\left[ \begin{matrix} 1 & 0 \\\ 0 & 1 \end{matrix} \right] \left[ \begin{matrix} 1000 \\\ 2000 \end{matrix}   \right]^{-1}~ %]]></script>

<script type="math/tex; mode=display">% <![CDATA[
\textrm{Technical Coefficient Matrix: }~A = Xz \Rightarrow A = \left[ \begin{matrix} .15 & .25 \\\ .2 & .05 \end{matrix} \right] %]]></script>

<p>To calculate matrix A in R: first take the inverse of the total output vector and multiply it with an identity matrix. The resulting object, <code>z</code>, is multiplied again with the <code>flowtable</code> matrix.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">## Calcate coefficient matrix:</span><span class="w">
</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">totaloutput</span><span class="w"> </span><span class="p">)</span><span class="o">^</span><span class="m">-1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">diag</span><span class="p">(</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">A</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">flowtable</span><span class="w"> </span><span class="o">%*%</span><span class="w"> </span><span class="n">z</span><span class="w">

</span><span class="c1"># Show A</span><span class="w">
</span><span class="n">A</span><span class="w">
     </span><span class="p">[,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="p">[,</span><span class="m">2</span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">,]</span><span class="w"> </span><span class="m">0.15</span><span class="w"> </span><span class="m">0.25</span><span class="w">
</span><span class="p">[</span><span class="m">2</span><span class="p">,]</span><span class="w"> </span><span class="m">0.20</span><span class="w"> </span><span class="m">0.05</span></code></pre></figure>

<p>Alternatively, we can use R’s <code>sweep()</code> function to calculate A directly from the <code>flowmatrix</code> and the <code>totaloutput</code> vector. <code>sweep()</code> takes the input matrix and divides each column by the corresponding entry of the vector. The argument <code>margin = 2</code> tells us we’re “sweeping” over the columns of the input matrix, as opposed to rows (for row-wise calculations, <code>margin = 1</code>).</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Using "Sweep"</span><span class="w">
</span><span class="n">A.alternative</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sweep</span><span class="p">(</span><span class="w"> </span><span class="n">flowtable</span><span class="w"> </span><span class="p">,</span><span class="w"> 
						</span><span class="n">margin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">,</span><span class="w"> 
						</span><span class="n">totaloutput</span><span class="w"> </span><span class="p">,</span><span class="w"> 
						</span><span class="s1">'/'</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">A.alternative</span><span class="w">
     </span><span class="p">[,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="p">[,</span><span class="m">2</span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">,]</span><span class="w"> </span><span class="m">0.15</span><span class="w"> </span><span class="m">0.25</span><span class="w">
</span><span class="p">[</span><span class="m">2</span><span class="p">,]</span><span class="w"> </span><span class="m">0.20</span><span class="w"> </span><span class="m">0.05</span></code></pre></figure>

<p>Finally, the Leontief matrix is calculated in the following way.</p>

<script type="math/tex; mode=display">% <![CDATA[
\textrm{Leontief Matrix: }~ L = (\textrm{I}_2 - A)^{-1} \Rightarrow L = \left[ \begin{matrix} 1.2541 & .33 \\\ .264 & 1.1221 \end{matrix}  \right] %]]></script>

<p>Using R, we first calculate <code>I-A</code>, substracting the technical coefficient matrix from the identity matrix. We then invert the I-A matrix by using the<code>solve()</code> function. The result, <code>L</code>, is the Leontief coefficient matrix.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Identity matrix minus technical coefficient matrix.</span><span class="w">
</span><span class="n">IminusA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">diag</span><span class="p">(</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">A</span><span class="w">

</span><span class="c1">## Calculate inverse.</span><span class="w">
</span><span class="n">L</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">solve</span><span class="p">(</span><span class="w"> </span><span class="n">IminusA</span><span class="w"> </span><span class="p">)</span><span class="w"> 

</span><span class="c1"># Show Leontief matrix.</span><span class="w">
</span><span class="n">L</span><span class="w">
          </span><span class="p">[,</span><span class="m">1</span><span class="p">]</span><span class="w">     </span><span class="p">[,</span><span class="m">2</span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="m">1</span><span class="p">,]</span><span class="w"> </span><span class="m">1.2541254</span><span class="w"> </span><span class="m">0.330033</span><span class="w">
</span><span class="p">[</span><span class="m">2</span><span class="p">,]</span><span class="w"> </span><span class="m">0.2640264</span><span class="w"> </span><span class="m">1.122112</span></code></pre></figure>

<p>Substantively, the matrix L summarizes the network effects generated when final output changes. A single coefficient of matrix L, surprisingly, summarizes <strong>all</strong> direct and indirect effects created in sector <strong>i</strong> to supply a single unit of final demand for sector <strong>j</strong>.</p>



			  <br>
			   <p class="post--date">11 Jul 2016</p>

	      </div>        
	    </div>
	  </div>
	</section>
</section>

<footer class="block block-footer-1">
  <div class="container">
    <p><a href="mailto:nathaniel.lane@gmail.com" title=""><strong>nathaniel.lane@monash.edu</strong></a> <span class="box"> • </span>Nathan Lane, 2014-2018 <span class="box"> • None of this garbage reflects my institution.</span></p>
  </div>
</footer>

  </body>
</html>
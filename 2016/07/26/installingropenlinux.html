<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <base href="">
    <title>Quick Note: Upgrading to Microsoft Open R in Linux - Nathan Lane - nathanlane.github.io</title>
    <meta name="author" content="Dr. Nathan Lane">
    <meta name="description" content="The personal webpage of Assistant Professor/Lecturer, Nathaniel Lane.">
    <link rel="stylesheet" href="/main.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Karla:300,400,700">
</head>
<body>

<header class="block block-header-1">

  <div class="block-header-1--logo">
  <a href="http://nathanlane.info">Nathanlane.info</a>
  </div>

  <div class="block-header-1--nav">
    <ul>
      
      <li class="nav-item "><a href="">Main</a></li>
      
      <li class="nav-item "><a href="http://nathanlane.info/blog">Blog</a></li>
      
      <li class="nav-item "><a href="https://www.dropbox.com/s/2xgg325wwayo9s9/NathanLane_IIES_20172018.pdf?dl=0">CV</a></li>
      
    </ul>
  </div>

</header>

<section class="post--content">
	<section class="block block-one-column-1">
	  <div class="container">
	    <div class="columns">
	      <div class="column">

			  <h1>Quick Note: Upgrading to Microsoft Open R in Linux</h1>
			  <p></p>

			  <p><img src="/assets/firstwheelie.jpg" width="700px" /></p>

<p>Below is a guide to installing Microsoft Open R for those using Ubuntu Linux and R-Studio. Microsoft R Open (MRO) is a pretty powerful distribution of R (and yes, completely open source). It builds off (currently) R version 3.3.0, adding some darn useful enhancements, due in part to their use of Intel’s Math Kernel Library (MKL).</p>

<h4>What is R Open + MKL?</h4>

<p>What does this mean? Basically Microsoft R Open is an optimized version of your standard R, and can help tremendously if you’re doing, say, many intense vector or matrix-based operations. Importantly, much of this is done for you: instead of having to fiddle around with multi-core support in your code, R Open optimizes things automatically.</p>

<p>Before stumbling across Revolution R, the predesessor to Microsoft R Open, I didn’t know there were <strong>other</strong> distributions of R floating around. Switching to Microsoft R Open simply means you’re installing an enhanced version of R over the default version. <strong>Everything</strong> works the same. There is nothing special you have to do (other than installing your previous packages, which is covered below). If you’re using RStudio, like most people out there, RStudio will automatically use the new, enhanced R.</p>

<h4>Upgrading to R Open</h4>

<p>Before installing <a href="https://mran.revolutionanalytics.com/open/ ">Microsoft R Open</a>, you want to keep track of all the packages you’ve installed. Because we’re installing a new version of R underneath RStudio, we wont have access to our old packages.</p>

<p>The following R code saves a list of packages that are currently installed in R. A <code>.Rda</code> file containing the installed package list will be saved in your default working directory. (If you need a reminder of your current working directory type <code>getwd()</code> into R.)</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Save a list of packges install in R.</span><span class="w">
</span><span class="n">temp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">installed.packages</span><span class="p">()</span><span class="w">
</span><span class="n">installedpackages</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.vector</span><span class="p">(</span><span class="w"> </span><span class="n">temp</span><span class="p">[</span><span class="w"> </span><span class="nf">is.na</span><span class="p">(</span><span class="w"> </span><span class="n">temp</span><span class="p">[</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s2">"Priority"</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">save</span><span class="p">(</span><span class="w"> </span><span class="n">installedpackages</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"oldpackages.rda"</span><span class="w"> </span><span class="p">)</span></code></pre></figure>

<p><small>
The above code is essentially the same as <a href="https://www.datascienceriot.com/how-to-upgrade-r-without-losing-your-packages/kris/">Data Science Riot</a>.
</small></p>

<p>Once we setup R Open, we’ll evoke this <code>.Rda</code> file to automatically (re-)install the old packages.</p>

<p>Next, we download and install Microsoft R Open: <a href="https://mran.revolutionanalytics.com/download/#download">https://mran.revolutionanalytics.com/download/</a>.</p>

<p>If, like me, you juggle multiple systems and can’t keep track of which version of Ubuntu you have, type the following command into the terminal:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">From your terminal:
lsb_release <span class="nt">-a</span></code></pre></figure>

<p>Then download the appropriate version of R Open <strong>and</strong> the MKL libraries.</p>

<p>After downloading, first install the Microsoft R Open Debian package:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>dpkg <span class="nt">-i</span> ./Downloads/MRO-3.3.0-Ubuntu-15.4.x86_64.deb
<span class="nb">sudo </span>apt-get install <span class="nt">-f</span></code></pre></figure>

<p>Next install the MKL libraries by unzipping and then running the installation script located in the <code>/RevoMath</code> directory:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">tar </span>xvfz ./Downloads/RevoMath-3.3.0.tar.gz
<span class="nb">cd </span>RevoMath
./RevoMath.sh</code></pre></figure>

<p>If everything has gone smoothly, the extra math libraries will have now been installed onto your system.</p>

<p>Now, re-open RStudio. Magically (and hopefully), RStudio should recognize the new R Open program and automatically setup the multi-core support. I have installed R Open on all my systems and have never had issues with RStudio recognizing the new flavour or R. If things have gone well, you should see the following message in the console RStudio console:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">Microsoft</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">Open</span><span class="w"> </span><span class="m">3.3.0</span><span class="w">
</span><span class="n">Default</span><span class="w"> </span><span class="n">CRAN</span><span class="w"> </span><span class="n">mirror</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="m">2016-06-01</span><span class="w">
</span><span class="n">The</span><span class="w"> </span><span class="n">enhanced</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">Microsoft</span><span class="w">
</span><span class="n">Visit</span><span class="w"> </span><span class="n">https</span><span class="o">://</span><span class="n">mran.microsoft.com</span><span class="o">/</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">information</span><span class="w">
</span><span class="n">about</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">features.</span><span class="w">

</span><span class="n">Multithreaded</span><span class="w"> </span><span class="n">BLAS</span><span class="o">/</span><span class="n">LAPACK</span><span class="w"> </span><span class="n">libraries</span><span class="w"> </span><span class="n">detected.</span><span class="w"> </span><span class="n">Using</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">cores</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">math</span><span class="w"> </span><span class="n">algorithms.</span></code></pre></figure>

<p>The message confirms that the combination or Microsoft R Open and the associated libraries have blessed you with multi-core support. Which saves you from having to setup a multi-core “by hand.”</p>

<p>Now that RStudio “sees” Microsoft R Open as our default version of R, we return to our <code>.Rda</code> file and use it to automatically install all the old packages:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">load</span><span class="p">(</span><span class="w"> </span><span class="s2">"oldpackages.rda"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">temp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">installed.packages</span><span class="p">()</span><span class="w">
</span><span class="n">installedpackages.new</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.vector</span><span class="p">(</span><span class="w"> </span><span class="n">temp</span><span class="p">[</span><span class="w"> </span><span class="nf">is.na</span><span class="p">(</span><span class="w"> </span><span class="n">temp</span><span class="p">[</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s2">"Priority"</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">missing</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">setdiff</span><span class="p">(</span><span class="w"> </span><span class="n">installedpackages</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">installedpackages.new</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">update.packages</span><span class="p">()</span></code></pre></figure>

<p>If you’re like me, you may have sit back for a while and watch R hypnotically re-install the list of packages onto your distribution.</p>


			  <br>
			   <p class="post--date">26 Jul 2016</p>

	      </div>        
	    </div>
	  </div>
	</section>
</section>

<footer class="block block-footer-1">
  <div class="container">
    <p><a href="mailto:nathaniel.lane@gmail.com" title=""><strong>nathaniel.lane@monash.edu</strong></a> <span class="box"> • </span>Nathan Lane, 2014-2018 <span class="box"> • None of this garbage reflects my institution.</span></p>
  </div>
</footer>

  </body>
</html>